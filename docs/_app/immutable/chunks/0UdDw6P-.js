import{f as W,a as F}from"./Di61MV9l.js";import{o as be}from"./DXQ0fkFu.js";import{p as we,b,d as ie,h as X,g as e,e as v,t as z,a as ye,c as d,u as B,s as w,r as c}from"./CYmiEaEH.js";import{s as J}from"./cfR1Foc9.js";import{p as P,i as _e,b as ce}from"./_y1boTp2.js";import{S as de,e as Oe,i as Se,s as Re,b as fe,c as Te}from"./CnAfG7ip.js";var De=W("<h5> </h5>"),Ie=W('<tr><td><div class="mr-2 h-4 w-4 rounded-full"></div></td><td class="w-24 truncate text-left font-semibold"> </td><td class="w-16 text-right"> </td></tr>'),ke=W('<div><!> <div class="flex w-full flex-row gap-4"><div class="h-64 grow overflow-hidden rounded-md border border-gray-200"><canvas class="h-full w-full bg-(--back-color)"></canvas></div> <div class="flex w-48 flex-col gap-2"><!> <!> <div><h5 class="px-4">Values</h5> <table class="w-full font-mono text-sm"><tbody></tbody></table></div></div></div></div>');function Ge(me,y){we(y,!0);let ve=P(y,"id",19,()=>crypto.randomUUID()),ue=P(y,"wrapperClass",3,""),E=P(y,"label",19,()=>({name:"",class:""})),r=P(y,"streamingData",23,()=>({data:[],timestamp:Date.now()})),H=P(y,"isTest",3,!1),o=b(ie([])),T=b(ie([])),D,u,s,_=b(600),h=b(125);const j=[{id:"RefreshOption-AUTO",name:"AUTO",value:0,class:""},{id:"RefreshOption-10",name:"10",value:10,class:""},{id:"RefreshOption-25",name:"25",value:25,class:""},{id:"RefreshOption-50",name:"50",value:50,class:""},{id:"RefreshOption-100",name:"100",value:100,class:""},{id:"RefreshOption-250",name:"250",value:250,class:""},{id:"RefreshOption-500",name:"500",value:500,class:""},{id:"RefreshOption-1000",name:"1000",value:1e3,class:""},{id:"RefreshOption-5000",name:"5000",value:5e3,class:""}],q=[{id:"ScaleOption-50",name:"50",value:50,class:""},{id:"ScaleOption-100",name:"100",value:100,class:""},{id:"ScaleOption-500",name:"500",value:500,class:""},{id:"ScaleOption-1000",name:"1000",value:1e3,class:""},{id:"ScaleOption-2000",name:"2000",value:2e3,class:""}];let O=b(0),I=b(100);const L=B(()=>e(O)==0?20:100),Y=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899"];let K=b(0);const Q=()=>{if(typeof r()=="string"&&r(JSON.parse(r())),!r().data||r().data.length===0){v(o,[],!0),v(T,[],!0);return}const t=r().data.slice(0,6).map((a,n)=>{const i=e(o).find(m=>m.name===a.name)||e(o)[n];return{id:i?.id||crypto.randomUUID(),points:i?.points||[],color:Y[n%Y.length],name:a.name||`Value ${n}`}});JSON.stringify(e(o))!==JSON.stringify(t)&&(v(o,t,!0),v(T,r().data.map(a=>a.value||0),!0))};be(Q),X(()=>{Q()});let U;X(()=>(clearInterval(U),e(O)>0&&r().data&&r().data.length>0?U=setInterval(()=>{let t;H()?t=e(o).map(()=>Math.random()*100-50):t=r().data.map(n=>n.value);const a=Date.now();t.forEach((n,i)=>{e(o)[i]&&(e(o)[i].points.push({x:a,y:n}),e(o)[i].points.length>e(L)&&e(o)[i].points.shift(),e(T)[i]=n)}),M()},e(O)):e(O)==0&&r().data&&r().data.length>0&&!H()&&(U=setInterval(()=>{e(K)<(r().timestamp??Date.now())&&(r().data.map(a=>a.value).forEach((a,n)=>{e(o)[n]&&(e(o)[n].points.push({x:r().timestamp??Date.now(),y:a}),e(o)[n].points.length>e(L)&&e(o)[n].points.shift(),e(T)[n]=a)}),M(),v(K,r().timestamp??Date.now(),!0))},10)),()=>clearInterval(U)));let G;X(()=>{if(!D||!u)return;const t=window.devicePixelRatio||1;return G=new ResizeObserver(()=>{const a=D.getBoundingClientRect();v(_,a.width,!0),v(h,a.height,!0),u.width=e(_)*t,u.height=e(h)*t,u.style.width=`${e(_)}px`,u.style.height=`${e(h)}px`,s=u.getContext("2d"),s.setTransform(t,0,0,t,0,0),M()}),G.observe(D),()=>G.disconnect()});const M=()=>{if(!s)return;s.clearRect(0,0,e(_),e(h));const t={top:10,right:10,bottom:20,left:35},a=e(_)-t.left-t.right,n=e(h)-t.top-t.bottom,i=e(o).flatMap(l=>l.points),m=Math.min(...i.map(l=>l.x)),S=Math.max(...i.map(l=>l.x))-m||1,g=l=>t.left+(l-m)/S*a,p=l=>t.top+n-(l/e(I)*n/2+n/2);s.strokeStyle="#777",s.fillStyle="#777",s.lineWidth=.5,s.font="10px monospace",s.textAlign="center";const N=Date.now();for(let l=0;l<=10;l++){const x=m+l/10*S,f=g(x),R=((x-N)/1e3).toFixed(0);s.beginPath(),s.moveTo(f,t.top),s.lineTo(f,e(h)-t.bottom),s.stroke(),s.textBaseline="top",s.fillText(`${R}s`,f,e(h)-t.bottom+2)}s.textAlign="right",s.textBaseline="middle";const C=8;for(let l=0;l<=C;l++){const x=e(I)-l*2*e(I)/C,f=p(x);s.beginPath(),s.moveTo(t.left,f),s.lineTo(e(_)-t.right,f),s.stroke(),s.fillText(`${x.toFixed(0)}`,t.left-5,f)}s.lineWidth=2,e(o).forEach(({points:l,color:x})=>{if(l.length<2)return;s.strokeStyle=x,s.beginPath(),s.moveTo(g(l[0].x),p(l[0].y));for(let R=1;R<l.length-1;R++){const V=l[R],oe=l[R+1],ge=(V.x+oe.x)/2,xe=(V.y+oe.y)/2;s.quadraticCurveTo(g(V.x),p(V.y),g(ge),p(xe))}const f=l[l.length-1];s.lineTo(g(f.x),p(f.y)),s.stroke()})};var k=ke(),Z=d(k);{var pe=t=>{var a=De(),n=d(a,!0);c(a),z(()=>{fe(a,1,`w-full px-4 text-center ${E().class}`),J(n,E().name)}),F(t,a)};_e(Z,t=>{E().name&&t(pe)})}var $=w(Z,2),A=d($),he=d(A);ce(he,t=>u=t,()=>u),c(A),ce(A,t=>D=t,()=>D);var ee=w(A,2),te=d(ee);{let t=B(()=>j.find(a=>a.value==e(O)));de(te,{label:{name:"Refresh rate",class:""},get options(){return j},get value(){return e(t)},onUpdate:a=>v(O,a.value,!0)})}var ae=w(te,2);{let t=B(()=>q.find(a=>a.value==e(I)));de(ae,{label:{name:"Scale"},get options(){return q},get value(){return e(t)},onUpdate:a=>v(I,a.value,!0)})}var se=w(ae,2),le=w(d(se),2),ne=d(le);Oe(ne,21,()=>e(o),Se,(t,a,n)=>{var i=Ie(),m=d(i),re=d(m);c(m);var S=w(m),g=d(S,!0);c(S);var p=w(S),N=d(p,!0);c(p),c(i),z(C=>{Te(re,`background-color: ${e(a).color??""}`),J(g,r().data?.[n]?.name),J(N,C)},[()=>e(T)[n].toFixed(2)]),F(t,i)}),c(ne),c(le),c(se),c(ee),c($),c(k),z(()=>{Re(k,"id",ve()),fe(k,1,`relative flex w-full flex-col items-center justify-center ${ue()}`)}),F(me,k),ye()}export{Ge as G};
